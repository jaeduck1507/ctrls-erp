<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.erp.fm.mapper.TransactionMapper">
	
	<resultMap id="TransMap" type="TransDTO">
		<id property="transNo" column="trans_no"/>
		<result property="transType" column="trans_type"/>
		<result property="transAmount" column="trans_amount"/>
		<result property="category" column="category"/>
		<result property="transDesc" column="trans_desc"/>
		<result property="transDate" column="trans_date"/>
		<result property="deptNo" column="dept_no"/>
		<result property="deptName" column="dept_name"/>
	</resultMap>
	
	<select id="showtrans" parameterType="TransDTO" resultMap="TransMap">
		SELECT trans_no, trans_type, trans_amount, category, trans_desc, trans_date, dept_name
		FROM transaction
		JOIN department USING(dept_no)
		<where>
			<if test="startDate != null and endDate != null">
				trans_date BETWEEN #{startDate} AND #{endDate}
			</if>
			<if test="transType != 'all'">
				AND trans_type = #{transType}
			</if>
			<if test="deptName != 'dept'">
				AND dept_name = #{deptName}
			</if>
		</where>
		ORDER BY trans_date
	</select>
	
	<insert id="transRegister" parameterType="ArrayList">
		INSERT INTO transaction(trans_type, trans_amount, category, trans_desc, trans_date, dept_no) VALUES
		<foreach collection="tList" item="trans" separator=",">
		(#{trans.transType},#{trans.transAmount},#{trans.category},#{trans.transDesc},#{trans.transDate},#{trans.deptNo})
		</foreach>
	</insert>
	
</mapper>